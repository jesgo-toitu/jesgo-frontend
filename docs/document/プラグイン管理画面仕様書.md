# プラグイン画面

## 初期処理

- 画面遷移防止処理を追加する
- データベースから以下の情報をまとめて読み込む
  - ログインユーザ名
  - 施設名
  - プラグイン情報

## ヘッダ部

- ヘッダ部を画面上部に表示
- タイトルロゴを画面左部に表示
- ロゴの右に画面名「プラグイン管理」を表示
- 右寄せで左から順に以下を表示
  - 施設名
    - データベースより取得した施設名を表示
  - ログインユーザ名
    - 現在ログインしているユーザのユーザ名を表示
    - クリック可能でプルダウンメニューを表示する
      - プルダウンメニューはパスワード変更、ログアウトの 2 つ
  - 画面リンク
    - クリック可能でプルダウンメニューを表示、以下の画面に遷移可能とする
      - 利用者管理
      - スキーマ管理
      - プラグイン管理
      - 設定
  - バージョン
    - アプリケーションに設定されているバージョン情報を表示する

## ボタン部

- ヘッダ部の下にボタン部を表示
- 右寄せで左から順に以下を表示
  - プラグインアップロード
    - 押下でファイルダイアログが開き、プラグインをアップロードできる
  - リストに戻る
    - 押下で患者リスト画面に戻る

## テーブル部

- テーブル部はボタン部の下に表示し、ボディ部分のみがスクロールし、画面内に表全体の表示部が収まるようにする
- DB から削除されていないプラグインの一覧を読込み、1 行毎に全てのプラグインを表示する
- 内容は常に最新とし、アップロード、削除等の処理が合った場合、処理後に表示を更新する
- テーブル項目として以下を表示する、表示領域の割合はバージョンとプラグイン種別、ボタン部を小さめに設定する
  - プラグイン名
    - プラグイン名を表示
  - バージョン
    - プラグインのバージョンを表示
  - プラグイン種別
    - プラグインを「データ出力」か「データ抽出」に分けて表示する
  - 対象スキーマ名
    - 対象となるスキーマをタイトル取得し、表示する
      - タイトルはサブタイトルがある場合半角スペースでつなげて表示する
      - 複数指定されている可能性があるため、複数個の場合は改行表示を行う
  - 詳細
    - プラグインの詳細説明を表示
  - ボタン類
    - テーブル項目としてはヘッダに何も表示しない
    - ボタンはグループ化し、左から順に以下を表示する、アイコンもそれに則したものとする
      - 詳細表示
        - 別タブでスクリプトの内容を表示する
        - 既にスクリプト表示用のタブを開いている場合はその画面の表示を更新する(スクリプト表示用のタブは 2 個開かない)
      - ダウンロード
        - 該当のスクリプトをダウンロードする
        - ファイル名は ★TODO とする
      - 削除
        - 削除確認ダイアログを表示し、OK であれば該当プラグインを論理削除する

## プラグインアップロード機能

- プラグインアップロードボタンを押下した際に処理を実行する
- ファイル選択ダイアログを開き、js ファイルか zip ファイルのアップロードを行う
- アップロードしたファイルが正常に処理された場合はその旨のダイアログを表示し、テーブルを更新する
- アップロードしたファイルに何かしら問題があり、正常に処理されなかった場合にはエラー内容をダイアログに表示する
  - エラーの際も表示の更新は行う
